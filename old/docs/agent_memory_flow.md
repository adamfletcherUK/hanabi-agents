# Agent Memory and Conversation Flow Diagrams

This document provides visual representations of how memory and conversation flow in the Hanabi AI agent implementation.

## Memory Architecture Diagram

```
┌─────────────────────────────────────────────────────────────────┐
│                        Game Engine                              │
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────────────┐  │
│  │  Game State │    │ Discussion  │    │ Turn Management     │  │
│  │             │    │ Manager     │    │                     │  │
│  └──────┬──────┘    └──────┬──────┘    └─────────┬───────────┘  │
│         │                  │                     │              │
└─────────┼──────────────────┼─────────────────────┼──────────────┘
          │                  │                     │
          ▼                  ▼                     ▼
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────────────┐  │
│  │ Filtered    │    │ Current     │    │ Previous Turns      │  │
│  │ Game View   │    │ Discussion  │    │ History             │  │
│  └──────┬──────┘    └──────┬──────┘    └─────────┬───────────┘  │
│         │                  │                     │              │
└─────────┼──────────────────┼─────────────────────┼──────────────┘
          │                  │                     │
          ▼                  ▼                     ▼
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│                          Agent Memory                           │
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────────────┐  │
│  │ Game State  │    │ Discussion  │    │ Game History        │  │
│  │ View        │    │ History     │    │                     │  │
│  └─────────────┘    └─────────────┘    └─────────────────────┘  │
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────────────┐  │
│  │ Game        │    │ Internal    │    │ Reasoning Graph     │  │
│  │ Summary     │    │ Thoughts    │    │ (LangGraph)         │  │
│  └─────────────┘    └─────────────┘    └─────────────────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

## Conversation Flow Between Turns

```
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│     Turn N      │     │    Turn N+1     │     │    Turn N+2     │
└────────┬────────┘     └────────┬────────┘     └────────┬────────┘
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│  Discussion     │     │  Discussion     │     │  Discussion     │
│  History        │     │  History        │     │  History        │
│  (Current Turn) │     │  (Current Turn) │     │  (Current Turn) │
└────────┬────────┘     └────────┬────────┘     └────────┬────────┘
         │                       │                       │
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│                 │     │                 │     │                 │
│  Game History   │◄────┼─────────────────┼─────┼───────────────► │  Game History   │
│  (Persistent)   │     │  Game History   │     │  (Persistent)   │
│                 │     │  (Persistent)   │     │                 │
└─────────────────┘     └─────────────────┘     └─────────────────┘
```

## Agent Memory Update Process

```
┌─────────────────────────────────────────────────────────────────┐
│                         End of Turn N                           │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                    Discussion Manager                           │
│                                                                 │
│  ┌─────────────────┐          │          ┌─────────────────┐    │
│  │  Discussion     │          │          │  Game History   │    │
│  │  History        │──────────┼─────────►│  (Persistent)   │    │
│  │  (Current Turn) │          │          │                 │    │
│  └─────────────────┘          │          └─────────────────┘    │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                    Game Engine                                  │
│                                                                 │
│  ┌─────────────────┐          │          ┌─────────────────┐    │
│  │  Action         │          │          │  Updated Game   │    │
│  │  Execution      │──────────┼─────────►│  State          │    │
│  │                 │          │          │                 │    │
│  └─────────────────┘          │          └─────────────────┘    │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                    Agent Memory Update                          │
│                                                                 │
│  ┌─────────────────┐          │          ┌─────────────────┐    │
│  │  Game History   │          │          │  Game Summary   │    │
│  │  Update         │◄─────────┼─────────►│  Update         │    │
│  │                 │          │          │                 │    │
│  └─────────────────┘          │          └─────────────────┘    │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                         Start of Turn N+1                       │
└─────────────────────────────────────────────────────────────────┘
```

## Information Flow in Agent Reasoning

```
┌─────────────────────────────────────────────────────────────────┐
│                         Agent Reasoning                         │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                    Input Processing                             │
│                                                                 │
│  ┌─────────────────┐    ┌─────────────┐    ┌─────────────────┐  │
│  │ Filtered Game   │    │ Current     │    │ Previous Turns  │  │
│  │ State           │    │ Discussion  │    │ History         │  │
│  └────────┬────────┘    └──────┬──────┘    └────────┬────────┘  │
│           │                    │                    │           │
└───────────┼────────────────────┼────────────────────┼───────────┘
            │                    │                    │
            ▼                    ▼                    ▼
┌─────────────────────────────────────────────────────────────────┐
│                    LangGraph Reasoning                          │
│                                                                 │
│  ┌─────────────────┐    ┌─────────────┐    ┌─────────────────┐  │
│  │ Analyze Game    │───►│ Generate    │───►│ Propose         │  │
│  │ State           │    │ Thoughts    │    │ Action          │  │
│  └─────────────────┘    └─────────────┘    └─────────────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                    Output Processing                            │
│                                                                 │
│  ┌─────────────────┐    ┌─────────────┐    ┌─────────────────┐  │
│  │ Discussion      │    │ Action      │    │ Memory          │  │
│  │ Contribution    │    │ Decision    │    │ Update          │  │
│  └─────────────────┘    └─────────────┘    └─────────────────┘  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

## Memory Preservation Between Turns

```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  Agent 0    │     │  Agent 1    │     │  Agent 2    │
└──────┬──────┘     └──────┬──────┘     └──────┬──────┘
       │                   │                   │
       ▼                   ▼                   ▼
┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│  Memory     │     │  Memory     │     │  Memory     │
│             │     │             │     │             │
│ ┌─────────┐ │     │ ┌─────────┐ │     │ ┌─────────┐ │
│ │Game     │ │     │ │Game     │ │     │ │Game     │ │
│ │History  │ │     │ │History  │ │     │ │History  │ │
│ └─────────┘ │     │ └─────────┘ │     │ └─────────┘ │
│             │     │             │     │             │
│ ┌─────────┐ │     │ ┌─────────┐ │     │ ┌─────────┐ │
│ │Game     │ │     │ │Game     │ │     │ │Game     │ │
│ │Summary  │ │     │ │Summary  │ │     │ │Summary  │ │
│ └─────────┘ │     │ └─────────┘ │     │ └─────────┘ │
└──────┬──────┘     └──────┬──────┘     └──────┬──────┘
       │                   │                   │
       │                   │                   │
       ▼                   ▼                   ▼
┌─────────────────────────────────────────────────────┐
│                                                     │
│              Discussion Manager                     │
│                                                     │
│  ┌─────────────────┐      ┌─────────────────┐      │
│  │  Discussion     │      │  Game History   │      │
│  │  History        │─────►│  (Persistent)   │      │
│  │  (Current Turn) │      │                 │      │
│  └─────────────────┘      └─────────────────┘      │
│                                                     │
└─────────────────────────────────────────────────────┘
``` 